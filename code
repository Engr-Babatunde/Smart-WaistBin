#include <NewPing.h>
#include <SoftwareSerial.h>
#include <Servo.h>

// ---------- Pins ----------
#define TRIG_LID 4
#define ECHO_LID 5
#define TRIG_BIN 9
#define ECHO_BIN 10
#define MAX_DISTANCE 200

// ---------- Objects ----------
NewPing lidSensor(TRIG_LID, ECHO_LID, MAX_DISTANCE);
NewPing binSensor(TRIG_BIN, ECHO_BIN, MAX_DISTANCE);
SoftwareSerial gsm(7, 8); // GSM module RX, TX
Servo lidMotor;

// ---------- Parameters ----------
const int binHeight = 50;        
const int thresholdPercent = 80;  
const int openDistance = 15;      
bool lidOpen = false;

void setup() {
  Serial.begin(9600);
  gsm.begin(9600);

// servo motor
  lidMotor.attach(6);  
  lidMotor.write(0);   

  delay(2000);
  Serial.println("Smart Wastebin System Starting...");
  sendSMS("Smart Wastebin System Initialized.");
}

void loop() {
  checkLid();       
  checkFillLevel(); 
  delay(500);      
}

// ---------- Lid Automation ----------
void checkLid() {
  int distance = lidSensor.ping_cm();

  if (distance > 0 && distance < openDistance && !lidOpen) {
    Serial.println("Object detected! Opening lid...");
    lidMotor.write(90); 
    lidOpen = true;
    delay(5000);        
  } else if (lidOpen) {
    Serial.println("Closing lid...");
    lidMotor.write(0);  
    lidOpen = false;
    delay(1000);
  }
}

// ---------- Bin Fill Monitoring ----------
void checkFillLevel() {
  int distance = binSensor.ping_cm();
